<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Brighton College Prep Kensington - Enquiry Form | Nursery</title>
  <meta name="description" content="Request your personalised prospectus for Brighton College Prep Kensington Nursery">
  <link rel="stylesheet" href="../styles/bcpk-form.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
  <div class="bcpk-form-page">
    <div class="bcpk-form-container">
      <!-- Header -->
      <div class="bcpk-form-header">
        <img src="../assets/logo/bcpk-logo.png" alt="Brighton College Prep Kensington" class="bcpk-form-header__logo" onerror="this.style.display='none'; this.parentElement.insertAdjacentHTML('afterbegin', '<div style=\'font-family: var(--font-serif); color: var(--bcpk-magenta-light); margin-bottom: 1rem;\'>BCPK</div>')">
        <h1 class="bcpk-form-header__title">Your Personalised Prospectus</h1>
        <p class="bcpk-form-header__subtitle">Nursery - Ages 2-4</p>
      </div>

      <!-- Progress Indicator -->
      <div class="bcpk-form-progress">
        <div class="bcpk-form-progress__step active" data-step="1"></div>
        <div class="bcpk-form-progress__step" data-step="2"></div>
        <div class="bcpk-form-progress__step" data-step="3"></div>
        <div class="bcpk-form-progress__step" data-step="4"></div>
        <div class="bcpk-form-progress__step" data-step="5"></div>
        <div class="bcpk-form-progress__step" data-step="6"></div>
      </div>
      <p class="bcpk-form-progress__text">Step <span id="currentStep">1</span> of 6</p>

      <!-- Garden Icons Decoration -->
      <div class="bcpk-garden-icons">
        <span class="bcpk-garden-icon">&#127793;</span>
        <span class="bcpk-garden-icon">&#127795;</span>
        <span class="bcpk-garden-icon">&#127807;</span>
        <span class="bcpk-garden-icon">&#127795;</span>
        <span class="bcpk-garden-icon">&#127793;</span>
      </div>

      <form id="bcpkEnquiryForm" novalidate>
        <!-- Section 1: About Your Child -->
        <div class="bcpk-form-section active" data-section="1">
          <h2 class="bcpk-form-section__title">About Your Child</h2>
          <p class="bcpk-form-section__description">Tell us about your little one so we can personalise their prospectus.</p>

          <div class="bcpk-form-row">
            <div class="bcpk-form-group">
              <label for="childFirstName">Child's First Name <span class="required">*</span></label>
              <input type="text" id="childFirstName" name="child_first_name" class="bcpk-input" required minlength="2" placeholder="e.g., Sophie">
              <span class="bcpk-error-message">Please enter your child's first name</span>
            </div>

            <div class="bcpk-form-group">
              <label for="childSurname">Child's Surname <span class="required">*</span></label>
              <input type="text" id="childSurname" name="child_surname" class="bcpk-input" required minlength="2" placeholder="e.g., Williams">
              <span class="bcpk-error-message">Please enter your child's surname</span>
            </div>
          </div>

          <div class="bcpk-form-group">
            <label>Child's Gender <span class="required">*</span></label>
            <div class="bcpk-radio-group bcpk-radio-group--inline">
              <label class="bcpk-radio">
                <input type="radio" name="child_gender" value="boy" required>
                <span>Boy</span>
              </label>
              <label class="bcpk-radio">
                <input type="radio" name="child_gender" value="girl">
                <span>Girl</span>
              </label>
              <label class="bcpk-radio">
                <input type="radio" name="child_gender" value="prefer_not_to_say">
                <span>Prefer not to say</span>
              </label>
            </div>
            <span class="bcpk-error-message">Please select an option</span>
          </div>

          <div class="bcpk-form-group">
            <label for="childDob">Date of Birth <span class="required">*</span></label>
            <input type="date" id="childDob" name="child_dob" class="bcpk-input" required>
            <span class="bcpk-error-message">Please enter your child's date of birth</span>
          </div>
        </div>

        <!-- Section 2: Entry Point -->
        <div class="bcpk-form-section" data-section="2">
          <h2 class="bcpk-form-section__title">When Would You Like to Start?</h2>
          <p class="bcpk-form-section__description">Children can join our Nursery from age 2.</p>

          <div class="bcpk-form-group">
            <label>Session Preference <span class="required">*</span></label>
            <div class="bcpk-radio-group">
              <label class="bcpk-radio">
                <input type="radio" name="session_type" value="full_time" required>
                <span>Full-time (5 days per week)</span>
              </label>
              <label class="bcpk-radio">
                <input type="radio" name="session_type" value="mornings">
                <span>Mornings only (5 mornings)</span>
              </label>
              <label class="bcpk-radio">
                <input type="radio" name="session_type" value="afternoons">
                <span>Afternoons only (5 afternoons)</span>
              </label>
              <label class="bcpk-radio">
                <input type="radio" name="session_type" value="undecided">
                <span>Undecided - Show me all options</span>
              </label>
            </div>
            <span class="bcpk-error-message">Please select a preference</span>
          </div>

          <div class="bcpk-form-group">
            <label for="entryTerm">Intended Start Term <span class="required">*</span></label>
            <select id="entryTerm" name="entry_term" class="bcpk-select" required>
              <option value="">Select term</option>
              <option value="September 2025">September 2025</option>
              <option value="January 2026">January 2026</option>
              <option value="April 2026">April 2026</option>
              <option value="September 2026">September 2026</option>
              <option value="January 2027">January 2027</option>
              <option value="April 2027">April 2027</option>
            </select>
            <span class="bcpk-error-message">Please select a start term</span>
          </div>

          <div class="bcpk-form-group">
            <label class="bcpk-checkbox">
              <input type="checkbox" name="reception_interest" value="true">
              <span>We are also interested in Reception for September 2026 or later</span>
            </label>
          </div>
        </div>

        <!-- Section 3: Your Child's Interests -->
        <div class="bcpk-form-section" data-section="3">
          <h2 class="bcpk-form-section__title">What Does Your Child Love?</h2>
          <p class="bcpk-form-section__description">Help us understand what makes your child light up!</p>

          <div class="bcpk-form-group">
            <label>Activities They Enjoy (select all that apply)</label>
            <div class="bcpk-multiselect-grid">
              <label class="bcpk-multiselect-item">
                <input type="checkbox" name="activities" value="Outdoor play">
                Outdoor play
              </label>
              <label class="bcpk-multiselect-item">
                <input type="checkbox" name="activities" value="Arts & crafts">
                Arts & crafts
              </label>
              <label class="bcpk-multiselect-item">
                <input type="checkbox" name="activities" value="Music">
                Music & singing
              </label>
              <label class="bcpk-multiselect-item">
                <input type="checkbox" name="activities" value="Stories">
                Stories & books
              </label>
              <label class="bcpk-multiselect-item">
                <input type="checkbox" name="activities" value="Building">
                Building / Lego
              </label>
              <label class="bcpk-multiselect-item">
                <input type="checkbox" name="activities" value="Nature">
                Nature / Animals
              </label>
              <label class="bcpk-multiselect-item">
                <input type="checkbox" name="activities" value="Roleplay">
                Roleplay / Dressing up
              </label>
              <label class="bcpk-multiselect-item">
                <input type="checkbox" name="activities" value="Dancing">
                Dancing
              </label>
              <label class="bcpk-multiselect-item">
                <input type="checkbox" name="activities" value="Sand & water">
                Sand & water play
              </label>
              <label class="bcpk-multiselect-item">
                <input type="checkbox" name="activities" value="Puzzles">
                Puzzles
              </label>
            </div>
          </div>

          <div class="bcpk-form-group">
            <label for="specialNotes">Anything special about your child? (Optional)</label>
            <textarea id="specialNotes" name="special_notes" class="bcpk-textarea" placeholder="Tell us about their personality, any special interests, or anything that makes them unique..."></textarea>
          </div>
        </div>

        <!-- Section 4: What's Important to You -->
        <div class="bcpk-form-section" data-section="4">
          <h2 class="bcpk-form-section__title">What's Important to You</h2>
          <p class="bcpk-form-section__description">What aspects of nursery education matter most?</p>

          <div class="bcpk-form-group">
            <label>Key Priorities (select all that apply)</label>
            <div class="bcpk-multiselect-grid">
              <label class="bcpk-multiselect-item">
                <input type="checkbox" name="priorities" value="Secret Garden">
                The Secret Garden
              </label>
              <label class="bcpk-multiselect-item">
                <input type="checkbox" name="priorities" value="Forest School">
                Forest School
              </label>
              <label class="bcpk-multiselect-item">
                <input type="checkbox" name="priorities" value="Small classes">
                Small class sizes
              </label>
              <label class="bcpk-multiselect-item">
                <input type="checkbox" name="priorities" value="Kindness">
                Culture of kindness
              </label>
              <label class="bcpk-multiselect-item">
                <input type="checkbox" name="priorities" value="Early learning">
                Early literacy & numeracy
              </label>
              <label class="bcpk-multiselect-item">
                <input type="checkbox" name="priorities" value="Play-based">
                Play-based learning
              </label>
              <label class="bcpk-multiselect-item">
                <input type="checkbox" name="priorities" value="Transition">
                Smooth transition to Reception
              </label>
              <label class="bcpk-multiselect-item">
                <input type="checkbox" name="priorities" value="Brighton College">
                Part of Brighton College family
              </label>
            </div>
          </div>
        </div>

        <!-- Section 5: Parent/Guardian Details -->
        <div class="bcpk-form-section" data-section="5">
          <h2 class="bcpk-form-section__title">Parent/Guardian Details</h2>
          <p class="bcpk-form-section__description">So we can send you the personalised prospectus.</p>

          <div class="bcpk-form-row">
            <div class="bcpk-form-group">
              <label for="parent1Title">Title <span class="required">*</span></label>
              <select id="parent1Title" name="parent1_title" class="bcpk-select" required>
                <option value="">Select title</option>
                <option value="Mr">Mr</option>
                <option value="Mrs">Mrs</option>
                <option value="Ms">Ms</option>
                <option value="Dr">Dr</option>
                <option value="Other">Other</option>
              </select>
            </div>

            <div class="bcpk-form-group">
              <label for="parent1Relationship">Relationship <span class="required">*</span></label>
              <select id="parent1Relationship" name="parent1_relationship" class="bcpk-select" required>
                <option value="">Select relationship</option>
                <option value="Mother">Mother</option>
                <option value="Father">Father</option>
                <option value="Guardian">Guardian</option>
                <option value="Other">Other</option>
              </select>
            </div>
          </div>

          <div class="bcpk-form-row">
            <div class="bcpk-form-group">
              <label for="parent1FirstName">First Name <span class="required">*</span></label>
              <input type="text" id="parent1FirstName" name="parent1_first_name" class="bcpk-input" required>
            </div>

            <div class="bcpk-form-group">
              <label for="parent1Surname">Surname <span class="required">*</span></label>
              <input type="text" id="parent1Surname" name="parent1_surname" class="bcpk-input" required>
            </div>
          </div>

          <div class="bcpk-form-row">
            <div class="bcpk-form-group">
              <label for="parent1Email">Email <span class="required">*</span></label>
              <input type="email" id="parent1Email" name="parent1_email" class="bcpk-input" required placeholder="email@example.com">
            </div>

            <div class="bcpk-form-group">
              <label for="parent1Phone">Phone <span class="required">*</span></label>
              <input type="tel" id="parent1Phone" name="parent1_phone" class="bcpk-input" required placeholder="+44 7700 900123">
            </div>
          </div>
        </div>

        <!-- Section 6: Consent & Submission -->
        <div class="bcpk-form-section" data-section="6">
          <h2 class="bcpk-form-section__title">Almost There!</h2>
          <p class="bcpk-form-section__description">Please review and confirm before we create your personalised prospectus.</p>

          <!-- Preview Panel -->
          <div class="bcpk-form-preview" id="formPreview">
            <h3 class="bcpk-form-preview__title">Your Prospectus Preview</h3>
            <div class="bcpk-form-preview__item"><strong>Child:</strong> <span id="previewChildName">-</span></div>
            <div class="bcpk-form-preview__item"><strong>Start:</strong> <span id="previewEntry">-</span></div>
            <div class="bcpk-form-preview__item"><strong>Sessions:</strong> <span id="previewSessions">-</span></div>
          </div>

          <div class="bcpk-form-group">
            <label class="bcpk-checkbox">
              <input type="checkbox" name="privacy_consent" required>
              <span>I confirm that the information provided is accurate and I consent to Brighton College Prep Kensington processing this data to create a personalised prospectus. <a href="https://www.brightoncollegeprepkensington.co.uk/privacy-policy" target="_blank">View Privacy Policy</a> <span class="required">*</span></span>
            </label>
          </div>

          <div class="bcpk-form-group">
            <label class="bcpk-checkbox">
              <input type="checkbox" name="marketing_consent">
              <span>I would like to receive news and updates from Brighton College Prep Kensington</span>
            </label>
          </div>

          <div class="bcpk-form-group">
            <label for="source">How did you hear about us?</label>
            <select id="source" name="source" class="bcpk-select">
              <option value="">Select an option</option>
              <option value="Word of mouth">Word of mouth / Recommendation</option>
              <option value="School fair">School fair or exhibition</option>
              <option value="Online search">Online search (Google, etc.)</option>
              <option value="Social media">Social media</option>
              <option value="Good Schools Guide">Good Schools Guide</option>
              <option value="Other">Other</option>
            </select>
          </div>
        </div>
      </form>

      <!-- Form Navigation -->
      <div class="bcpk-form-nav">
        <button type="button" class="bcpk-form-btn bcpk-form-btn--secondary" id="prevBtn" disabled>Back</button>
        <button type="button" class="bcpk-form-btn bcpk-form-btn--primary" id="nextBtn">Continue</button>
      </div>

      <!-- Success State -->
      <div class="bcpk-form-success" id="formSuccess" style="display: none;">
        <div class="bcpk-form-success__icon">&#10003;</div>
        <h2 class="bcpk-form-success__title">Thank You!</h2>
        <p class="bcpk-form-success__message">
          <span id="successChildName">Your child's</span> personalised nursery prospectus is being created now.
        </p>
        <div class="bcpk-loading">
          <div class="bcpk-loading__spinner"></div>
          <p class="bcpk-loading__text">Generating your prospectus...</p>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Nursery Form Controller
    class BCPKNurseryFormController {
      constructor() {
        this.form = document.getElementById('bcpkEnquiryForm');
        this.sections = document.querySelectorAll('.bcpk-form-section');
        this.progressSteps = document.querySelectorAll('.bcpk-form-progress__step');
        this.currentStepText = document.getElementById('currentStep');
        this.prevBtn = document.getElementById('prevBtn');
        this.nextBtn = document.getElementById('nextBtn');
        this.currentStep = 1;
        this.totalSteps = 6;

        this.init();
      }

      init() {
        this.prevBtn.addEventListener('click', () => this.prevStep());
        this.nextBtn.addEventListener('click', () => this.nextStep());

        // Multi-select toggle
        document.querySelectorAll('.bcpk-multiselect-item input[type="checkbox"]').forEach(input => {
          input.addEventListener('change', () => {
            const item = input.closest('.bcpk-multiselect-item');
            item.classList.toggle('selected', input.checked);
          });
        });

        // Radio toggle styling
        document.querySelectorAll('.bcpk-radio input').forEach(radio => {
          radio.addEventListener('change', () => {
            const group = radio.closest('.bcpk-radio-group');
            group.querySelectorAll('.bcpk-radio').forEach(r => r.classList.remove('selected'));
            radio.closest('.bcpk-radio').classList.add('selected');
          });
        });

        // Update preview on change
        this.form.addEventListener('change', () => this.updatePreview());
        this.form.addEventListener('input', () => this.updatePreview());
      }

      updateProgress() {
        this.progressSteps.forEach((step, index) => {
          step.classList.remove('active', 'completed');
          if (index + 1 === this.currentStep) {
            step.classList.add('active');
          } else if (index + 1 < this.currentStep) {
            step.classList.add('completed');
          }
        });
        this.currentStepText.textContent = this.currentStep;
        this.prevBtn.disabled = this.currentStep === 1;
        this.nextBtn.textContent = this.currentStep === this.totalSteps ? 'Create Prospectus' : 'Continue';
      }

      showSection(step) {
        this.sections.forEach((section, index) => {
          section.classList.toggle('active', index + 1 === step);
        });
        this.updateProgress();
        window.scrollTo({ top: 0, behavior: 'smooth' });
      }

      validateCurrentSection() {
        const currentSection = this.sections[this.currentStep - 1];
        const requiredFields = currentSection.querySelectorAll('[required]');
        let isValid = true;

        requiredFields.forEach(field => {
          const formGroup = field.closest('.bcpk-form-group');

          if (field.type === 'radio') {
            const name = field.name;
            const checked = currentSection.querySelector(`input[name="${name}"]:checked`);
            if (!checked) {
              isValid = false;
              formGroup?.classList.add('has-error');
            } else {
              formGroup?.classList.remove('has-error');
            }
          } else if (!field.value.trim()) {
            isValid = false;
            field.classList.add('error');
            formGroup?.classList.add('has-error');
          } else {
            field.classList.remove('error');
            formGroup?.classList.remove('has-error');
          }
        });

        return isValid;
      }

      nextStep() {
        if (!this.validateCurrentSection()) return;

        if (this.currentStep < this.totalSteps) {
          this.currentStep++;
          this.showSection(this.currentStep);
        } else {
          this.submitForm();
        }
      }

      prevStep() {
        if (this.currentStep > 1) {
          this.currentStep--;
          this.showSection(this.currentStep);
        }
      }

      updatePreview() {
        const childName = document.getElementById('childFirstName')?.value || '-';
        const childSurname = document.getElementById('childSurname')?.value || '';
        const entryTerm = document.getElementById('entryTerm')?.value || '-';
        const sessionType = document.querySelector('input[name="session_type"]:checked')?.value || '-';

        document.getElementById('previewChildName').textContent = `${childName} ${childSurname}`.trim();
        document.getElementById('previewEntry').textContent = entryTerm;

        const sessionMap = {
          'full_time': 'Full-time',
          'mornings': 'Mornings only',
          'afternoons': 'Afternoons only',
          'undecided': 'Undecided'
        };
        document.getElementById('previewSessions').textContent = sessionMap[sessionType] || sessionType;
      }

      collectFormData() {
        const formData = new FormData(this.form);

        const data = {
          child: {
            first_name: formData.get('child_first_name'),
            surname: formData.get('child_surname'),
            gender: formData.get('child_gender'),
            date_of_birth: formData.get('child_dob')
          },
          entry: {
            session_type: formData.get('session_type'),
            entry_term: formData.get('entry_term'),
            reception_interest: formData.get('reception_interest') === 'true',
            prospectus_type: 'nursery'
          },
          interests: {
            activities: formData.getAll('activities'),
            special_notes: formData.get('special_notes')
          },
          priorities: formData.getAll('priorities'),
          parents: {
            parent1: {
              title: formData.get('parent1_title'),
              first_name: formData.get('parent1_first_name'),
              surname: formData.get('parent1_surname'),
              email: formData.get('parent1_email'),
              phone: formData.get('parent1_phone'),
              relationship: formData.get('parent1_relationship')
            }
          },
          source: formData.get('source'),
          consent: {
            privacy: formData.get('privacy_consent') === 'on',
            marketing: formData.get('marketing_consent') === 'on'
          },
          submitted_at: new Date().toISOString()
        };

        return data;
      }

      submitForm() {
        const data = this.collectFormData();
        localStorage.setItem('bcpk_prospectus_data', JSON.stringify(data));

        this.form.style.display = 'none';
        document.querySelector('.bcpk-form-nav').style.display = 'none';
        document.getElementById('formSuccess').style.display = 'block';
        document.getElementById('successChildName').textContent = data.child.first_name + "'s";

        setTimeout(() => {
          window.location.href = '../prospectus/nursery.html';
        }, 2000);
      }
    }

    document.addEventListener('DOMContentLoaded', () => {
      new BCPKNurseryFormController();
    });
  </script>
</body>
</html>
